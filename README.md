# Play & Record 기반 DBSAFER GUI 자동화 시스템

DBSAFER 보안 제품 테스트를 위한 **녹화 및 재생 기반 GUI 자동화 테스트 프레임워크**입니다.

---

## 개요

본 프로젝트는 DB 접근제어 솔루션 DBSAFER의 GUI 설정 과정을 'Play & Record' 방식으로 자동화한 Python 기반 도구입니다.
사용자의 마우스 클릭 및 키 입력 동작을 시나리오 형태로 기록하고, 이를 기반으로 GUI 설정 작업을 재현 및 반복 실행할 수 있도록 설계되었습니다.
반복적이고 오류 가능성이 높은 수작업 설정을 자동화함으로써, 설정의 일관성과 업무 효율성을 동시에 향상시킵니다.
핵심 기술로는 pyautogui를 사용하였으며, 단순 자동화를 넘어 GUI 설정 표준화와 플레이백 기반 유지보수를 고려한 구조를 갖추고 있습니다.

---

## 주요 기능

- **녹화 및 재생(Record & Play)**  
  애플리케이션에서의 사용자 상호작용을 녹화하고 이를 테스트 시 재생

- **테스트 케이스 관리**  
  상세한 메타데이터를 기반으로 테스트 케이스 생성, 구성 및 관리

- **다양한 검증 방식 지원**  
  데이터베이스 쿼리 또는 이미지 기반 비교를 통한 결과 검증

- **데이터베이스 연동**  
  테스트 중 데이터베이스 상태를 확인하고 검증 가능

- **리포트 기능**  
  테스트 결과를 정리한 리포트 자동 생성

---

## 주요 구성 요소

### 핵심 컴포넌트

- **MacroPerformer**  
  녹화된 UI 상호작용(클릭, 키보드 입력 등)을 대상 애플리케이션에 수행

- **MacroValidator**  
  이미지 비교 또는 DB 쿼리를 통해 테스트 결과 검증

- **MacroRunner**  
  스프레드시트 기반으로 테스트 케이스를 순차 실행

- **AppStarter**  
  애플리케이션 실행 및 프로세스 관리 담당

- **Database**  
  DB 연결 및 검증을 위한 쿼리 실행 관리

### 유틸리티 컴포넌트

- **InputDialog**  
  테스트 케이스를 작성하고 수정할 수 있는 사용자 인터페이스

- **SpreadSheet**  
  Excel 기반 테스트 케이스 저장 및 관리

- **LogHandler**  
  애플리케이션 전반의 로그 관리

- **Progress**  
  테스트 진행 상태를 추적 및 보고

---

## 테스트 케이스 구조

각 테스트 케이스는 다음과 같은 항목을 포함합니다:

- **메타데이터**: ID, 제품명, 요약, 타입, 버전
- **그룹핑**: 정책/오브젝트, 서비스 유형 등 계층적 그룹 분류
- **사전 조건**: 로그인 여부 등 필요한 애플리케이션 상태
- **매크로 목록**: 실행할 UI 상호작용 시퀀스
- **검증 방식**: 이미지 또는 쿼리를 통한 검증 유형 및 데이터
- **예상 결과**: 기대하는 테스트 결과 값

---

## 지원 애플리케이션

- Enterprise Manager  
- DBSafer Agent  

---

## 사용 방법

### 테스트 케이스 녹화

1. 대상 애플리케이션을 실행
2. InputDialog를 통해 새로운 테스트 케이스 생성
3. 애플리케이션 상호작용 녹화
4. 이미지 비교 또는 DB 쿼리 기반 검증 기준 설정
5. Excel 파일로 테스트 케이스 저장

### 테스트 케이스 실행

1. Excel 또는 JSON 파일에서 테스트 케이스 불러오기
2. MacroRunner를 사용해 테스트 케이스 실행
3. MacroValidator로 결과 검증
4. 성공/실패 여부가 포함된 리포트 자동 생성

---

## 구성 파일

`config.yaml` 파일을 통해 다음을 설정할 수 있습니다:

- DB 연결 정보  
- 애플리케이션 경로  
- 테스트 케이스 메타데이터 옵션  
- 이미지 저장용 Google Drive 연동  
- 로그 출력 설정

---

## 개발 정보

### 사전 조건

- Python 3.x
- 필수 라이브러리: `pywinauto`, `pynput`, `pymysql`, `openpyxl` 등
- DBSAFER 애플리케이션에 접근 가능한 환경

### 프로젝트 구조

- **Core Files**: 주요 기능을 담은 스크립트들 (`macro_*.py`)
- **Utility Files**: 보조 기능 스크립트 (`my_utils.py`, `shared.py`)
- **UI Files**: 사용자 인터페이스 구성 요소 (`input_dialog.py`)
- **Configuration**: 설정 파일 (`config.yaml`)
- **Data Storage**: Excel, JSON, 이미지 등 테스트 데이터

---

## 라이선스

독점 소프트웨어 – PNP SECURE

---

## 작성자

QA, 조재근
